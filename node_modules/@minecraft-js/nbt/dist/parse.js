"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseNBT = void 0;
const bufwrapper_1 = require("@minecraft-js/bufwrapper");
const node_zlib_1 = require("node:zlib");
const Compound_1 = require("./datatypes/Compound");
function parseNBT(buffer) {
    if (buffer[0] === 0x1f && buffer[1] === 0x8b)
        // NBT is Gzip'd
        buffer = (0, node_zlib_1.gunzipSync)(buffer);
    else if (buffer[0] === 0x78 && [0x01, 0x9c, 0xda].includes(buffer[1]))
        // NBT is Zlib'd
        buffer = (0, node_zlib_1.inflateSync)(buffer);
    const buf = new bufwrapper_1.BufWrapper(buffer);
    const implicitCompound = new Compound_1.NBT_Compound(undefined);
    return implicitCompound.read(buf)[0];
}
exports.parseNBT = parseNBT;
